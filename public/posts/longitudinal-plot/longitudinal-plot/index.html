<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="About the data example: The aortic root sizes were measured over time for two groups of patients. The change of root size over time is of interest. In this analysis, we first plotted the group mean at each discrete time to visualize the root growth, secondly modeled the continuous time effect of root growth. The data is setup in a long format that each subject with ID (sBAV_ID_Number) has multiple rows with multiple measurements at different times.">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="longitudinal plot (SAS)" />
<meta property="og:description" content="About the data example: The aortic root sizes were measured over time for two groups of patients. The change of root size over time is of interest. In this analysis, we first plotted the group mean at each discrete time to visualize the root growth, secondly modeled the continuous time effect of root growth. The data is setup in a long format that each subject with ID (sBAV_ID_Number) has multiple rows with multiple measurements at different times." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/longitudinal-plot/longitudinal-plot/" />
<meta property="article:published_time" content="2021-03-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-03-12T00:00:00+00:00" />
<title>longitudinal plot (SAS) | Code Notes</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.da110f27d6a4d632dc8e162876b7216c5c1f82164fbdac7ff33021633767f034.css" >
  <script defer src="/flexsearch.min.js"></script>
  <script defer src="/en.search.min.749d7c271df6abe70b0289b06850f266513170445f852261eec0da3a0ae8a711.js" ></script>

  <script defer src="/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js" ></script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-XXXXXXXXX-X', 'auto');
	
	ga('send', 'pageview');
}
</script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>Code Notes</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  



  
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/blog-down/blog-down/" class="">Using R Blogdown for Site Building</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-31f51f1e983d3fcd191b1a670dd370c1" class="toggle"  />
    <label for="section-31f51f1e983d3fcd191b1a670dd370c1" class="flex justify-between">
      <a href="/docs/plot/" class="">Plot</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/plot/sankey/sankey-020722/" class="">Sankey diagram (R)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/plot/odds-ratio-forest-plot/odds-ratio-forest-plot/" class="">Odds Ratio Forest Plot (R)</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-0a41e1f9be9b219b00fc23f1b7c32d3f" class="toggle"  />
    <label for="section-0a41e1f9be9b219b00fc23f1b7c32d3f" class="flex justify-between">
      <a href="/docs/psm/" class="">Propensity score methods</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/psm/psm/psm/" class="">Propensity score methods-I PS Matching (SAS)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/psm/ps-weighting/ps-weighting/" class="">Propensity score weighting methods (R)</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/mixed-effect-model-icc/mixed-effect-and-icc81121/" class="">Mixed effect model simulation and ICC (R)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/collinearity/collinearity/" class="">Collinearity (SAS)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/longitudinal-plot/longitudinal-plot/" class="">Longitudinal plot (SAS)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/power-linear-regression-model/simulation-to-calculate-power-in-linear-regression-model/" class="">Use simulation to calculate power in linear regression model (R)</a>
  

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var menu=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>longitudinal plot (SAS)</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  




  </aside>
  
 
      </header>

      
      
<article class="markdown">
  <h1>
    <a href="/posts/longitudinal-plot/longitudinal-plot/">longitudinal plot (SAS)</a>
  </h1>
  
  <h5>Mar 12, 2021</h5>



  
  <div>
    
      <a href="/categories/sas/">SAS</a>
  </div>
  

  
  <div>
    
      <a href="/tags/repeated-measurements/">Repeated measurements</a>
  </div>
  






<p>About the data example: The aortic root sizes were measured over time for two groups of patients. The change of root size over time is of interest. In this analysis, we first plotted the group mean at each discrete time to visualize the root growth, secondly modeled the continuous time effect of root growth. The data is setup in a long format that each subject with ID (sBAV_ID_Number) has multiple rows with multiple measurements at different times.</p>
<ol style="list-style-type: decimal">
<li>To generate longitudinal plots:</li>
</ol>
<pre class="r"><code>*plot the group mean over time with formatting; 

goptions reset=all ftext=swiss ;
axis1 label=(h=2 a=90 &quot;Root size (mm)&quot;) value=( h=2 );
axis2 label= (h=2 &quot;Time (year)&quot;) value=( h=2 );
legend1 label=(f=swiss h=2  &#39;Root Group&#39;)  value=(h=2 color=black  &#39;root control&#39; &#39;root dilation&#39; ) ;

* time2 is a decrete time variable in the dataset; 
proc sort data=rootdat out=rootdat_t nodupkey; by sBAV_ID_Number time2;run;  

proc gplot data=rootdat_t;
plot root_size*time2=Root_group / haxis=axis2 vaxis=axis1 legend = legend1 ;
symbol1 c=red i= std1mjt  l=1 w=2 mode=include r=1;
symbol2 c=blue i= std1mjt  l=2  w=2 mode=include r=1;
title h=3 &quot;Average root size by group with standard errors of means&quot;;
run;
quit;</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Output the plot</li>
</ol>
<pre class="r"><code>ods graphics on / reset=all imagefmt=tiff imagename=&quot;KM_Stented_vs_Stentless&quot;;
ods listing style=Statistical gpath=&quot;C:\xx&quot;;
ods graphics on / width=5in;
ods listing image_dpi=500;run;</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>To model the change of aorta root over time, time is modeled as a continuous variable in the model. The Class variable time is used in the repeated statement with compound symmetry as the covariance matrix to account for residual correlation within a subject. Mixed effect model is preferred when the longitudinal data is unbalanced. Repeated ANOVA is only used for balanced data. The interaction between group effect and time is tested first, if not significant, will be removed from the model.</li>
</ol>
<pre class="r"><code>**model; 
*timcl2 is class variable that is placed at the repeated statement to account for patient level (sBAV_ID) cluster; 
* time is modeled as a countinous variable. 

proc sort data=rootdat; by sBAV_ID_Number timecl;run;
data rootdat; set rootdat;  timecl2=time;run;

Proc mixed data=rootdat method=ml covtest empirical;
class sBAV_ID_Number  Root_group (ref=&#39;0&#39;) timecl2;
model root_size = time Root_group time*Root_group/ solution;
repeated timecl2 / type =CS subject = sBAV_ID_Number;
run;

******if the interaction is not significant****;

Proc mixed data=rootdat method=ml covtest empirical;
class sBAV_ID_Number  Root_group (ref=&#39;0&#39;) timecl2;
model root_size = time Root_group / solution;
repeated timecl2 / type =CS subject = sBAV_ID_Number;
run;


******if there were an interaction****;
Proc mixed data=rootdat_t method=ml covtest empirical;
class sBAV_ID_Number  Root_group (ref=&#39;0&#39;) timecl ;
model root_size = time2 Root_group time2*Root_group / solution;
repeated  timecl/ type =CS subject = sBAV_ID_Number;
estimate &quot;root group_diff at 5 y&quot;  Root_group 1 -1
                             time2*Root_group   5 -5;

estimate &quot;root group_diff at 10 y&quot;  Root_group 1 -1
                            time2*Root_group   10 -10;

estimate &quot;root group_diff at 15 y&quot;  Root_group 1 -1
                             time2*Root_group   15 -15;

estimate &quot;time effect for group 1&quot; time2 1 0
                                   time2*Root_group   1 0;
estimate &quot;time effect for group 0&quot; time2 1 0
                                   time2*Root_group   0 1;
run;</code></pre>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function select(element){const selection=window.getSelection();const range=document.createRange();range.selectNodeContents(element);selection.removeAllRanges();selection.addRange(range);}
document.querySelectorAll("pre code").forEach(code=>{code.addEventListener("click",function(event){select(code.parentElement);if(navigator.clipboard){navigator.clipboard.writeText(code.parentElement.textContent);}});});})();</script>


 
        
      </footer>

      
  
  <div class="book-comments">
<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "my-site" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  



 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












